function convSheetAndEmail(rng)
{
  var first = '<table class="nl-container" style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; min-width: 320px; margin: 0 auto; background-color: #ffffff; width: 100%;" cellspacing="0" cellpadding="0"><tbody><tr style="vertical-align: top;"><td style="word-break: break-word; border-collapse: collapse !important; vertical-align: top;"><div style="background-color: transparent;"><div class="block-grid " style="margin: 0 auto; min-width: 320px; max-width: 600px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"><div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><div class="col num12" style="min-width: 320px; max-width: 600px; display: table-cell; vertical-align: top;"><div style="background-color: transparent; width: 100% !important;"><table class="divider " style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="100%" cellspacing="0" cellpadding="0"><tbody><tr style="vertical-align: top;"><td class="divider_inner" style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; min-width: 100%; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;"><table class="divider_content" style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; border-top: 0px solid transparent; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="100%" cellspacing="0" cellpadding="0" align="center"><tbody><tr style="vertical-align: top;"><td style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"> </td></tr></tbody></table></td></tr></tbody></table></div></div></div></div></div><div style="background-image: url(images/sayagata-200px.gif); background-position: top center; background-repeat: repeat; ;background-color: transparent;"><div class="block-grid " style="margin: 0 auto; min-width: 320px; max-width: 600px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"><div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><div class="col num12" style="min-width: 320px; max-width: 600px; display: table-cell; vertical-align: top;"><div style="background-color: transparent; width: 100% !important;"><div class=""><div style="line-height: 120%; color: #9b1384; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; padding: 30px 10px 5px 10px;"><div style="font-size: 12px; line-height: 14px; color: #9b1384; font-family: Montserrat, Trebuchet MS, Lucida Grande, Lucida Sans Unicode, Lucida Sans, Tahoma, sans-serif; text-align: left;"><p style="margin: 0; font-size: 12px; line-height: 14px; text-align: center;"><span style="font-size: 20px; line-height: 24px;">Yesterday\'s visitors report!</span></p></div></div></div><table class="divider " style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="100%" cellspacing="0" cellpadding="0"><tbody><tr style="vertical-align: top;"><td class="divider_inner" style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; min-width: 100%; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 15px 10px 20px 10px;"><table class="divider_content" style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; border-top: 10px solid #711083; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="15%" cellspacing="0" cellpadding="0" align="center"><tbody><tr style="vertical-align: top;"><td style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; font-size: 0px; line-height: 0px; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"> </td></tr></tbody></table></td></tr></tbody></table><div class="button-container center " style="padding: 0px 10px 30px 10px;" align="center"> <a style="display: block; text-decoration: none; -webkit-text-size-adjust: none; text-align: center; color: #ffffff; background-color: #711083; border-radius: 3px; -webkit-border-radius: 3px; -moz-border-radius: 3px; max-width: 230px; width: auto; border-top: 0px solid transparent; border-right: 0px solid transparent; border-bottom: 0px solid #59B7E0; border-left: 0px solid transparent; font-family: Lato, Tahoma, Verdana, Segoe, sans-serif; mso-border-alt: none; padding: 5px 20px 5px 20px;" href="'
  var full_report =  'YOUR_FULL_REPORT'
  var second = '" target="_blank"> <span style="line-height: 24px; font-size: 12px;"><span style="font-size: 18px; line-height: 36px;"><strong>ACCESS FULL REPORT</strong></span></span> </a> </div></div></div></div></div><div style="background-color: transparent;"><div class="block-grid " style="margin: 0 5%; min-width: 320px; max-width: 600px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"><div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><div class="col num12" style="min-width: 320px; max-width: 600px; display: table-cell; vertical-align: top;"><div style="background-color: transparent; width: 100% !important;"><table class="divider " style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; min-width: 100%; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="100%" cellspacing="0" cellpadding="0"><tbody><tr style="vertical-align: top;"><td class="divider_inner" style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; min-width: 100%; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; padding: 10px;"><table class="divider_content" style="border-collapse: collapse; table-layout: fixed; border-spacing: 0; mso-table-lspace: 0pt; mso-table-rspace: 0pt; vertical-align: top; border-top: 0px solid transparent; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;" border="0" width="100%" cellspacing="0" cellpadding="0" align="center"><tbody><tr style="vertical-align: top;"><td style="word-break: break-word; border-collapse: collapse !important; vertical-align: top; mso-line-height-rule: exactly; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;">'
  var HTML = SheetConverter.convertRange2html(rng);
  var third = '</td></tr></tbody></table></td></tr></tbody></table></div></div></div></div><div style="background-color: transparent;"><div class="block-grid " style="margin: 0 auto; min-width: 320px; max-width: 600px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"><div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><div class="col num12" style="min-width: 320px; max-width: 600px; display: table-cell; vertical-align: top;"><div style="background-color: transparent; width: 100% !important;"></div></div></div></div><div style="background-color: #f9f9f9;"><div class="block-grid " style="margin: 0 auto; min-width: 320px; max-width: 600px; overflow-wrap: break-word; word-wrap: break-word; word-break: break-word; background-color: transparent;"><div style="border-collapse: collapse; display: table; width: 100%; background-color: transparent;"><div class="col num12" style="min-width: 320px; max-width: 600px; display: table-cell; vertical-align: top;"><div style="background-color: transparent; width: 100% !important;"></div></div></div></div></div></div></td></tr></tbody></table>'
  MailApp.sendEmail({
    to: 'email@mail.ml',
    cc: 'email1@mail.ml, email2@mail.ml, email3@mail.ml',
    subject: 'Yesterday\'s visitors!',
    htmlBody : first + full_report + second + HTML + third 
  });
}

function doGet()
{
  var dataRange = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Report").getDataRange();
  convSheetAndEmail(dataRange);
}
